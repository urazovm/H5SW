<% if @items %>
  <% @items.each do |item| %>
    <li id="auto_res"><%= link_to_function item.name,"text_field_value('#{item.name}')" %></li>
  <% end %>
<% else %>
  no results
<% end %>
<style>
  ul li#auto_res{
    list-style-type: none;
    padding: 2px;
  }

  #auto_results{
    border: 1px solid grey;
    left: -24px;
    position: relative;
    top: -10px;
    width: 125px;
    display: none;
  }
</style>
<script>
  function text_field_value(item){
    var count = $("#auto_complete_text").val().split(',').length;
    var str = $("#auto_complete_text").val();
    var coma_len = $("#auto_complete_text").val().lastIndexOf(',')
    var fin = (str.length - coma_len)-1;
    if(count == 1){
      tex_val = ''
    }else{
      tex_val = str.slice(0,-fin);
    }
    $("#auto_complete_text").val(tex_val+''+item+',');
    $("#auto_results").hide();
    $.ajax({
      url:'/items/sub_total',
      data:{
        name:item,
        sub_to:$("#sub_total").val()
      },
      type:'GET',
      success:function(data){}
    });
  }
</script>
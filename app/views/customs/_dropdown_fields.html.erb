<% @value = current_login.dropdown_values.find_by_custom_id(params[:custom_id]) %>
<%= form_for @drop_downvalue,:url => update_dropdown_values_custom_path(@drop_downvalue),:method => 'PUT',:remote => true do |f| %>
  <%= f.hidden_field :custom_id,:value => @custom.id %>
  <% if custom.field == "Text Box" %>
    <%= f.text_field "drop_value" %>
  <% elsif custom.field == "Dropdown List" %>
    <% dropvalue = DropdownValue.find_by_custom_id_and_company_id(custom.id, current_login.id).drop_value.split(',').each %>
    <%= select_tag "dropdownField", options_for_select(dropvalue.each do |drop|[drop] end), :style => "width: 436px" %>
  <% elsif custom.field == "Calendar" %>
    <%= f.text_field "drop_value", :value => @value ? @value.drop_value : "", :class => 'data', :placeholder => Date.today %>&nbsp;
    <%= image_tag "calendar.png", :style => "width: 32px; height: 32px; cursor:pointer;", :id => "calendar_icon", :class => "datepicker"%>
  <% elsif custom.field == "Legend" %>
    <%= f.text_area "drop_value", :value => @value ? @value.drop_value : "default value", :rows => 5 %>
  <% elsif custom.field == "Table" %>
    <%= f.text_field "drop_value", :value => @value ? @value.drop_value : "default value" %>
  <% else %>
    ''
  <% end %>
  <%= f.submit 'update',:class => 'btn btn-small btn-primary' %>
  <%= link_to_function 'cancel', 'cancel_update_dropdown()',:class => 'btn btn-mini btn-primary', :style => "color:white;" %>
<% end %>

<script>
  function cancel_update_dropdown(id) {
    $("#custom_field_updation_<%= @custom.id %>").html('<%= escape_javascript render :partial => 'customs/replace_dropdown',:locals => {:custom => custom} %>');
  }

  $(document).ready(function() {
    /* Activating Best In Place */
    $('.datepicker').datepicker()
            .on('changeDate', function(e) {
      var y = e.date.getFullYear(),
              _m = e.date.getMonth() + 1,
              m = (_m > 9 ? _m : '0' + _m),
              _d = e.date.getDate(),
              d = (_d > 9 ? _d : '0' + _d);
      $(this).prev('input.data').val(y + '-' + m + '-' + d);
    });
  });
</script>